<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.557">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Methods in Humanities Analytics - 14&nbsp; Classification &amp; Authorship Attribution</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../reports/cbe_01.html" rel="next">
<link href="../tutorials/contextual-embeddings.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/text_analysis.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Methods in Humanities Analytics</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/browndw/humanities_analytics" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/classification-federalist-papers.html">Applications</a></li><li class="breadcrumb-item"><a href="../tutorials/classification-federalist-papers.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Classification &amp; Authorship Attribution</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/sentiment-and-syuzhet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Texts, Algorithms, and Black-Boxes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/corpus-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Corpus Basics: Tokenization and Processing Pipelines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/spacy-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">NLP Processing with spaCy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/frequency-and-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distributions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Core Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/keyness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Keyness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/collocations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Collocations and N-grams</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Time Series Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/topic-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Topic Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Advanced Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/categorical-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">ANOVA and R²: Comparing Groups and Explaining Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/cluster-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Clustering Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Correlation and Multi-Collinearity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/multi-dimensional-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multi-Dimensional Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/contextual-embeddings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Contextual Embeddings and Transformers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/classification-federalist-papers.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Classification &amp; Authorship Attribution</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Reports</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/cbe_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coffee Break Experiment #1: From Curiosity to Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/cbe_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coffee Break Experiment #2: From Results to Research</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/cbe_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coffee Break Experiment #3: Final Project Pilot Study</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/final-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Project: Independent Corpus Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/statistical-reporting-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Reporting Guide</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Course Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/using-colab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Using Google Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python Packages for This Course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Data Resources</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-classification" id="toc-introduction-to-classification" class="nav-link active" data-scroll-target="#introduction-to-classification"><span class="header-section-number">14.1</span> Introduction to Classification</a></li>
  <li><a href="#mosteller-wallaces-variables" id="toc-mosteller-wallaces-variables" class="nav-link" data-scroll-target="#mosteller-wallaces-variables"><span class="header-section-number">14.2</span> Mosteller &amp; Wallace’s Variables</a></li>
  <li><a href="#the-federalist-papers" id="toc-the-federalist-papers" class="nav-link" data-scroll-target="#the-federalist-papers"><span class="header-section-number">14.3</span> The Federalist Papers</a>
  <ul class="collapse">
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data"><span class="header-section-number">14.3.1</span> Load the Data</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">14.4</span> Data Preparation</a>
  <ul class="collapse">
  <li><a href="#create-document-term-matrix" id="toc-create-document-term-matrix" class="nav-link" data-scroll-target="#create-document-term-matrix"><span class="header-section-number">14.4.1</span> Create Document-Term Matrix</a></li>
  </ul></li>
  <li><a href="#traintest-split" id="toc-traintest-split" class="nav-link" data-scroll-target="#traintest-split"><span class="header-section-number">14.5</span> Train/Test Split</a></li>
  <li><a href="#random-forest-classification" id="toc-random-forest-classification" class="nav-link" data-scroll-target="#random-forest-classification"><span class="header-section-number">14.6</span> Random Forest Classification</a>
  <ul class="collapse">
  <li><a href="#train-the-model" id="toc-train-the-model" class="nav-link" data-scroll-target="#train-the-model"><span class="header-section-number">14.6.1</span> Train the Model</a></li>
  <li><a href="#feature-importance" id="toc-feature-importance" class="nav-link" data-scroll-target="#feature-importance"><span class="header-section-number">14.6.2</span> Feature Importance</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation"><span class="header-section-number">14.6.3</span> Validation</a></li>
  </ul></li>
  <li><a href="#full-model-all-mw-variables" id="toc-full-model-all-mw-variables" class="nav-link" data-scroll-target="#full-model-all-mw-variables"><span class="header-section-number">14.7</span> Full Model: All M&amp;W Variables</a></li>
  <li><a href="#predict-disputed-papers" id="toc-predict-disputed-papers" class="nav-link" data-scroll-target="#predict-disputed-papers"><span class="header-section-number">14.8</span> Predict Disputed Papers</a>
  <ul class="collapse">
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">14.8.1</span> Visualization</a></li>
  </ul></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">14.9</span> Interpretation</a></li>
  <li><a href="#what-this-demonstrates" id="toc-what-this-demonstrates" class="nav-link" data-scroll-target="#what-this-demonstrates"><span class="header-section-number">14.10</span> What This Demonstrates</a></li>
  <li><a href="#methodological-considerations" id="toc-methodological-considerations" class="nav-link" data-scroll-target="#methodological-considerations"><span class="header-section-number">14.11</span> Methodological Considerations</a>
  <ul class="collapse">
  <li><a href="#why-function-words" id="toc-why-function-words" class="nav-link" data-scroll-target="#why-function-words"><span class="header-section-number">14.11.1</span> Why Function Words?</a></li>
  <li><a href="#model-choice-random-forest-vs.-alternatives" id="toc-model-choice-random-forest-vs.-alternatives" class="nav-link" data-scroll-target="#model-choice-random-forest-vs.-alternatives"><span class="header-section-number">14.11.2</span> Model Choice: Random Forest vs.&nbsp;Alternatives</a></li>
  <li><a href="#sample-size-considerations" id="toc-sample-size-considerations" class="nav-link" data-scroll-target="#sample-size-considerations"><span class="header-section-number">14.11.3</span> Sample Size Considerations</a></li>
  </ul></li>
  <li><a href="#connections-to-other-methods" id="toc-connections-to-other-methods" class="nav-link" data-scroll-target="#connections-to-other-methods"><span class="header-section-number">14.12</span> Connections to Other Methods</a>
  <ul class="collapse">
  <li><a href="#multi-dimensional-analysis-mda" id="toc-multi-dimensional-analysis-mda" class="nav-link" data-scroll-target="#multi-dimensional-analysis-mda"><span class="header-section-number">14.12.1</span> Multi-Dimensional Analysis (MDA)</a></li>
  <li><a href="#contextual-embeddings" id="toc-contextual-embeddings" class="nav-link" data-scroll-target="#contextual-embeddings"><span class="header-section-number">14.12.2</span> Contextual Embeddings</a></li>
  <li><a href="#keyness-analysis" id="toc-keyness-analysis" class="nav-link" data-scroll-target="#keyness-analysis"><span class="header-section-number">14.12.3</span> Keyness Analysis</a></li>
  </ul></li>
  <li><a href="#extensions-applications" id="toc-extensions-applications" class="nav-link" data-scroll-target="#extensions-applications"><span class="header-section-number">14.13</span> Extensions &amp; Applications</a>
  <ul class="collapse">
  <li><a href="#historical-questions" id="toc-historical-questions" class="nav-link" data-scroll-target="#historical-questions"><span class="header-section-number">14.13.1</span> Historical Questions</a></li>
  <li><a href="#modern-applications" id="toc-modern-applications" class="nav-link" data-scroll-target="#modern-applications"><span class="header-section-number">14.13.2</span> Modern Applications</a></li>
  <li><a href="#ethical-considerations" id="toc-ethical-considerations" class="nav-link" data-scroll-target="#ethical-considerations"><span class="header-section-number">14.13.3</span> Ethical Considerations</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">14.14</span> Summary</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">14.15</span> Further Reading</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/browndw/humanities_analytics/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/classification-federalist-papers.html">Applications</a></li><li class="breadcrumb-item"><a href="../tutorials/classification-federalist-papers.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Classification &amp; Authorship Attribution</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-classification" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Classification &amp; Authorship Attribution</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Companion Notebook</strong>: <a href="https://colab.research.google.com/github/browndw/humanities_analytics/blob/main/mini_labs/Mini_Lab_12_Classification_Federalist.ipynb">Mini Lab 12: Classification &amp; Federalist Papers</a></p>
<p>In this chapter, we’ll (mostly) replicate a famous classification task first done by Frederick Mosteller and David L. Wallace in the early 1960s <span class="citation" data-cites="mosteller1963inference">(<a href="#ref-mosteller1963inference" role="doc-biblioref">Mosteller and Wallace 1963</a>)</span>. They undertook this without the benefit of modern text processing—it was truly pioneering work in computational linguistics and information theory. Keep that in mind as we do in minutes what took them months.</p>
<section id="introduction-to-classification" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="introduction-to-classification"><span class="header-section-number">14.1</span> Introduction to Classification</h2>
<p><strong>Classification</strong> is a supervised machine learning task where we train a model to predict categorical labels (classes) based on features. In text analysis, common classification tasks include:</p>
<ul>
<li><strong>Authorship attribution</strong>: Who wrote this text?</li>
<li><strong>Sentiment analysis</strong>: Is this review positive or negative?</li>
<li><strong>Genre classification</strong>: Is this a novel, poem, or essay?</li>
<li><strong>Topic classification</strong>: What subject does this article discuss?</li>
</ul>
<p><strong>Key concepts:</strong></p>
<ul>
<li><strong>Features</strong>: Measurable properties (e.g., word frequencies)</li>
<li><strong>Labels</strong>: Categories we want to predict (e.g., author names)</li>
<li><strong>Training data</strong>: Labeled examples used to build the model</li>
<li><strong>Validation data</strong>: Held-out data to test model performance</li>
<li><strong>Test data</strong>: New data where labels are unknown (what we want to predict)</li>
</ul>
<div id="4351c405" class="cell" data-message="false" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, confusion_matrix, classification_report</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set style</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mosteller-wallaces-variables" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="mosteller-wallaces-variables"><span class="header-section-number">14.2</span> Mosteller &amp; Wallace’s Variables</h2>
<p>Because of computational limits in the 1960s, Mosteller &amp; Wallace needed to identify potentially productive variables ahead of building their model. This is not how we would approach it now, but it was a constraint at the time. They created 3 groups of candidate words.</p>
<p>Their <strong>first group</strong> contains 70 common function words:</p>
<div id="b59ef58e" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mw_group1 <span class="op">=</span> [</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a"</span>, <span class="st">"all"</span>, <span class="st">"also"</span>, <span class="st">"an"</span>, <span class="st">"and"</span>, <span class="st">"any"</span>, <span class="st">"are"</span>, <span class="st">"as"</span>, <span class="st">"at"</span>, <span class="st">"be"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"been"</span>, <span class="st">"but"</span>, <span class="st">"by"</span>, <span class="st">"can"</span>, <span class="st">"do"</span>, <span class="st">"down"</span>, <span class="st">"even"</span>, <span class="st">"every"</span>, <span class="st">"for"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"from"</span>, <span class="st">"had"</span>, <span class="st">"has"</span>, <span class="st">"have"</span>, <span class="st">"her"</span>, <span class="st">"his"</span>, <span class="st">"if"</span>, <span class="st">"in"</span>, <span class="st">"into"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"is"</span>, <span class="st">"it"</span>, <span class="st">"its"</span>, <span class="st">"may"</span>, <span class="st">"more"</span>, <span class="st">"must"</span>, <span class="st">"my"</span>, <span class="st">"no"</span>, <span class="st">"not"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"now"</span>, <span class="st">"of"</span>, <span class="st">"on"</span>, <span class="st">"one"</span>, <span class="st">"only"</span>, <span class="st">"or"</span>, <span class="st">"our"</span>, <span class="st">"shall"</span>, <span class="st">"should"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"so"</span>, <span class="st">"some"</span>, <span class="st">"such"</span>, <span class="st">"than"</span>, <span class="st">"that"</span>, <span class="st">"the"</span>, <span class="st">"their"</span>, <span class="st">"then"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"there"</span>, <span class="st">"things"</span>, <span class="st">"this"</span>, <span class="st">"to"</span>, <span class="st">"up"</span>, <span class="st">"upon"</span>, <span class="st">"was"</span>, <span class="st">"were"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"what"</span>, <span class="st">"when"</span>, <span class="st">"which"</span>, <span class="st">"who"</span>, <span class="st">"will"</span>, <span class="st">"with"</span>, <span class="st">"would"</span>, <span class="st">"your"</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Their <strong>second group</strong> adds 47 more words:</p>
<div id="3dd80823" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mw_group2 <span class="op">=</span> [</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"affect"</span>, <span class="st">"again"</span>, <span class="st">"although"</span>, <span class="st">"among"</span>, <span class="st">"another"</span>, <span class="st">"because"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"between"</span>, <span class="st">"both"</span>, <span class="st">"city"</span>, <span class="st">"commonly"</span>, <span class="st">"consequently"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"considerable"</span>, <span class="st">"contribute"</span>, <span class="st">"defensive"</span>, <span class="st">"destruction"</span>, <span class="st">"did"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"direction"</span>, <span class="st">"disgracing"</span>, <span class="st">"either"</span>, <span class="st">"enough"</span>, <span class="st">"fortune"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"function"</span>, <span class="st">"himself"</span>, <span class="st">"innovation"</span>, <span class="st">"join"</span>, <span class="st">"language"</span>, <span class="st">"most"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nor"</span>, <span class="st">"offensive"</span>, <span class="st">"often"</span>, <span class="st">"pass"</span>, <span class="st">"perhaps"</span>, <span class="st">"rapid"</span>, <span class="st">"same"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"second"</span>, <span class="st">"still"</span>, <span class="st">"those"</span>, <span class="st">"throughout"</span>, <span class="st">"under"</span>, <span class="st">"vigor"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"violate"</span>, <span class="st">"violence"</span>, <span class="st">"voice"</span>, <span class="st">"where"</span>, <span class="st">"whether"</span>, <span class="st">"while"</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"whilst"</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Their <strong>third group</strong> includes 48 more content-bearing words (some originally lemmatized):</p>
<div id="3f8fb08d" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mw_group3 <span class="op">=</span> [</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"about"</span>, <span class="st">"according"</span>, <span class="st">"adversaries"</span>, <span class="st">"after"</span>, <span class="st">"aid"</span>, <span class="st">"always"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"apt"</span>, <span class="st">"asserted"</span>, <span class="st">"before"</span>, <span class="st">"being"</span>, <span class="st">"better"</span>, <span class="st">"care"</span>, <span class="st">"choice"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"common"</span>, <span class="st">"danger"</span>, <span class="st">"decide"</span>, <span class="st">"decides"</span>, <span class="st">"decided"</span>, <span class="st">"deciding"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"degree"</span>, <span class="st">"during"</span>, <span class="st">"expense"</span>, <span class="st">"expenses"</span>, <span class="st">"extent"</span>, <span class="st">"follow"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"follows"</span>, <span class="st">"followed"</span>, <span class="st">"following"</span>, <span class="st">"i"</span>, <span class="st">"imagine"</span>, <span class="st">"imagined"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"intrust"</span>, <span class="st">"intrusted"</span>, <span class="st">"intrusting"</span>, <span class="st">"kind"</span>, <span class="st">"large"</span>, <span class="st">"likely"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"matter"</span>, <span class="st">"matters"</span>, <span class="st">"moreover"</span>, <span class="st">"necessary"</span>, <span class="st">"necessity"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"necessities"</span>, <span class="st">"others"</span>, <span class="st">"particularly"</span>, <span class="st">"principle"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"probability"</span>, <span class="st">"proper"</span>, <span class="st">"propriety"</span>, <span class="st">"provision"</span>, <span class="st">"provisions"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"requisite"</span>, <span class="st">"substance"</span>, <span class="st">"they"</span>, <span class="st">"though"</span>, <span class="st">"truth"</span>, <span class="st">"truths"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"us"</span>, <span class="st">"usage"</span>, <span class="st">"usages"</span>, <span class="st">"we"</span>, <span class="st">"work"</span>, <span class="st">"works"</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All together: <strong>165 candidate variables</strong> (180 unlemmatized tokens).</p>
<div id="84959a4e" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all groups</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mw_all <span class="op">=</span> <span class="bu">sorted</span>(mw_group1 <span class="op">+</span> mw_group2 <span class="op">+</span> mw_group3)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total variables: </span><span class="sc">{</span><span class="bu">len</span>(mw_all)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total variables: 180</code></pre>
</div>
</div>
</section>
<section id="the-federalist-papers" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="the-federalist-papers"><span class="header-section-number">14.3</span> The Federalist Papers</h2>
<p>The <strong>Federalist Papers</strong> are 85 articles written by Alexander Hamilton, James Madison, and John Jay under the pseudonym “Publius” to promote ratification of the U.S. Constitution.</p>
<p><strong>Authorship breakdown:</strong></p>
<ul>
<li><strong>Hamilton</strong>: 51 papers</li>
<li><strong>Madison</strong>: 14 papers</li>
<li><strong>Jay</strong>: 5 papers</li>
<li><strong>Joint</strong> (Hamilton &amp; Madison): 3 papers</li>
<li><strong>Disputed</strong> (Hamilton or Madison?): 12 papers</li>
</ul>
<p>Authorship has been debated since publication. We’ll use the generally accepted attributions for known papers, then predict the disputed ones.</p>
<section id="load-the-data" class="level3" data-number="14.3.1">
<h3 data-number="14.3.1" class="anchored" data-anchor-id="load-the-data"><span class="header-section-number">14.3.1</span> Load the Data</h3>
<div id="512ddbd1" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load metadata</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>meta_url <span class="op">=</span> <span class="st">"https://github.com/browndw/humanities_analytics/raw/refs/heads/main/data/data_meta/federalist_meta.csv"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>fed_meta <span class="op">=</span> pl.read_csv(meta_url)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Authorship breakdown:"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fed_meta.group_by(<span class="st">'author_id'</span>).agg(pl.count()).sort(<span class="st">'count'</span>, descending<span class="op">=</span><span class="va">True</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Authorship breakdown:
shape: (5, 2)
┌──────────────────┬───────┐
│ author_id        ┆ count │
│ ---              ┆ ---   │
│ str              ┆ u32   │
╞══════════════════╪═══════╡
│ Hamilton         ┆ 51    │
│ Madison          ┆ 14    │
│ Disputed         ┆ 12    │
│ Jay              ┆ 5     │
│ Hamilton_Madison ┆ 3     │
└──────────────────┴───────┘</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3420/3030490263.py:6: DeprecationWarning: `pl.count()` is deprecated. Please use `pl.len()` instead.
(Deprecated in version 0.20.5)
  print(fed_meta.group_by('author_id').agg(pl.count()).sort('count', descending=True))</code></pre>
</div>
</div>
<div id="884a0e99" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load text data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data_url <span class="op">=</span> <span class="st">"https://github.com/browndw/humanities_analytics/raw/refs/heads/main/data/data_tables/federalist_papers.csv"</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fed_text <span class="op">=</span> pl.read_csv(data_url)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(fed_text)<span class="sc">}</span><span class="ss"> papers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 85 papers</code></pre>
</div>
</div>
</section>
</section>
<section id="data-preparation" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">14.4</span> Data Preparation</h2>
<p>We need to convert the raw text into a <strong>document-term matrix</strong> with word proportions. Why proportions? Paper length shouldn’t bias our model—a long paper will naturally have more occurrences of every word.</p>
<div id="176a7143" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join metadata with text</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fed_data <span class="op">=</span> fed_text.join(fed_meta.select([<span class="st">'doc_id'</span>, <span class="st">'author_id'</span>]), on<span class="op">=</span><span class="st">'doc_id'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="create-document-term-matrix" class="level3" data-number="14.4.1">
<h3 data-number="14.4.1" class="anchored" data-anchor-id="create-document-term-matrix"><span class="header-section-number">14.4.1</span> Create Document-Term Matrix</h3>
<p>We’ll tokenize the text and count Mosteller &amp; Wallace’s candidate words, converting counts to proportions:</p>
<div id="ae7e14fa" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_dtm(text, vocabulary):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Create document-term matrix with proportions for given vocabulary"""</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> text.lower().split()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    total_tokens <span class="op">=</span> <span class="bu">len</span>(tokens)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    word_counts <span class="op">=</span> {}</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word <span class="kw">in</span> vocabulary:</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> tokens.count(word)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        word_counts[word] <span class="op">=</span> count <span class="op">/</span> total_tokens <span class="cf">if</span> total_tokens <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> word_counts</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to all documents</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>dtm_data <span class="op">=</span> []</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> fed_data.iter_rows(named<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    word_props <span class="op">=</span> create_dtm(row[<span class="st">'text'</span>], mw_all)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    word_props[<span class="st">'doc_id'</span>] <span class="op">=</span> row[<span class="st">'doc_id'</span>]</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    word_props[<span class="st">'author_id'</span>] <span class="op">=</span> row[<span class="st">'author_id'</span>]</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    dtm_data.append(word_props)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to polars DataFrame</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>fed_data_prop <span class="op">=</span> pl.DataFrame(dtm_data)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>word_cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> fed_data_prop.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">'doc_id'</span>, <span class="st">'author_id'</span>]]</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>fed_data_prop <span class="op">=</span> fed_data_prop.select([<span class="st">'doc_id'</span>, <span class="st">'author_id'</span>] <span class="op">+</span> word_cols)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Document-term matrix: </span><span class="sc">{</span>fed_data_prop<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First few rows (sample):"</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fed_data_prop.select([<span class="st">'doc_id'</span>, <span class="st">'author_id'</span>] <span class="op">+</span> word_cols[:<span class="dv">5</span>]).head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Document-term matrix: (85, 182)

First few rows (sample):
shape: (5, 7)
┌───────────────┬───────────┬──────────┬───────┬───────────┬─────────────┬──────────┐
│ doc_id        ┆ author_id ┆ a        ┆ about ┆ according ┆ adversaries ┆ affect   │
│ ---           ┆ ---       ┆ ---      ┆ ---   ┆ ---       ┆ ---         ┆ ---      │
│ str           ┆ str       ┆ f64      ┆ f64   ┆ f64       ┆ f64         ┆ f64      │
╞═══════════════╪═══════════╪══════════╪═══════╪═══════════╪═════════════╪══════════╡
│ FEDERALIST_01 ┆ Hamilton  ┆ 0.01547  ┆ 0.0   ┆ 0.0       ┆ 0.0         ┆ 0.000619 │
│ FEDERALIST_02 ┆ Jay       ┆ 0.017344 ┆ 0.0   ┆ 0.0       ┆ 0.0         ┆ 0.0      │
│ FEDERALIST_03 ┆ Jay       ┆ 0.008978 ┆ 0.0   ┆ 0.0       ┆ 0.0         ┆ 0.001381 │
│ FEDERALIST_04 ┆ Jay       ┆ 0.00978  ┆ 0.0   ┆ 0.0       ┆ 0.0         ┆ 0.001222 │
│ FEDERALIST_05 ┆ Jay       ┆ 0.006682 ┆ 0.0   ┆ 0.0       ┆ 0.0         ┆ 0.0      │
└───────────────┴───────────┴──────────┴───────┴───────────┴─────────────┴──────────┘</code></pre>
</div>
</div>
<p><strong>What’s happening here?</strong></p>
<ol type="1">
<li><strong>Tokenization</strong>: Split text into words (lowercased)</li>
<li><strong>Count</strong>: For each M&amp;W word, count occurrences</li>
<li><strong>Normalize</strong>: Divide by total tokens to get proportion</li>
<li><strong>Result</strong>: Each row is a paper, each column is a word’s proportion</li>
</ol>
</section>
</section>
<section id="traintest-split" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="traintest-split"><span class="header-section-number">14.5</span> Train/Test Split</h2>
<p>We’ll separate papers into:</p>
<ul>
<li><strong>Training</strong>: Hamilton and Madison papers (known authors) for building the model</li>
<li><strong>Test</strong>: Disputed papers (what we want to predict)</li>
</ul>
<div id="2c72134b" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training data: known authors (Hamilton &amp; Madison only)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> fed_data_prop.<span class="bu">filter</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">'author_id'</span>) <span class="op">==</span> <span class="st">'Hamilton'</span>) <span class="op">|</span> (pl.col(<span class="st">'author_id'</span>) <span class="op">==</span> <span class="st">'Madison'</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Test data: disputed papers</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> fed_data_prop.<span class="bu">filter</span>(pl.col(<span class="st">'author_id'</span>) <span class="op">==</span> <span class="st">'Disputed'</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Training data: </span><span class="sc">{</span><span class="bu">len</span>(train_data)<span class="sc">}</span><span class="ss"> papers"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test data: </span><span class="sc">{</span><span class="bu">len</span>(test_data)<span class="sc">}</span><span class="ss"> papers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training data: 65 papers
Test data: 12 papers</code></pre>
</div>
</div>
</section>
<section id="random-forest-classification" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="random-forest-classification"><span class="header-section-number">14.6</span> Random Forest Classification</h2>
<p><strong>Why Random Forest?</strong></p>
<ul>
<li><strong>Ensemble method</strong>: Combines multiple decision trees</li>
<li><strong>Robust</strong>: Handles many features well</li>
<li><strong>Interpretable</strong>: Provides feature importance rankings</li>
<li><strong>Popular</strong>: Widely used in practice</li>
</ul>
<p><strong>How it works:</strong></p>
<ol type="1">
<li>Build many decision trees (100 in our case)</li>
<li>Each tree votes for a class (Hamilton or Madison)</li>
<li>Final prediction is the majority vote</li>
</ol>
<p>Let’s start with just Mosteller &amp; Wallace’s first group (70 words):</p>
<div id="4c579e9b" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select Group 1 variables</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>available_mw1 <span class="op">=</span> [word <span class="cf">for</span> word <span class="kw">in</span> mw_group1 <span class="cf">if</span> word <span class="kw">in</span> train_data.columns]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>train_g1 <span class="op">=</span> train_data.select([<span class="st">'doc_id'</span>, <span class="st">'author_id'</span>] <span class="op">+</span> available_mw1)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to numpy for sklearn</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>X_train_g1 <span class="op">=</span> train_g1.select(available_mw1).to_numpy()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>y_train_g1 <span class="op">=</span> train_g1.select(<span class="st">'author_id'</span>).to_numpy().flatten()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into train/validation (80/20)</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># stratify=y_train_g1 maintains class balance (51 Hamilton vs 14 Madison)</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>X_tr, X_val, y_tr, y_val <span class="op">=</span> train_test_split(</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    X_train_g1, y_train_g1, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">123</span>, stratify<span class="op">=</span>y_train_g1</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Training set: </span><span class="sc">{</span><span class="bu">len</span>(X_tr)<span class="sc">}</span><span class="ss"> papers"</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Validation set: </span><span class="sc">{</span><span class="bu">len</span>(X_val)<span class="sc">}</span><span class="ss"> papers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training set: 52 papers
Validation set: 13 papers</code></pre>
</div>
</div>
<section id="train-the-model" class="level3" data-number="14.6.1">
<h3 data-number="14.6.1" class="anchored" data-anchor-id="train-the-model"><span class="header-section-number">14.6.1</span> Train the Model</h3>
<div id="8fbfe84b" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest with 100 trees</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestClassifier(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    min_samples_split<span class="op">=</span><span class="dv">5</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>rf_model.fit(X_tr, y_tr)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Training accuracy: </span><span class="sc">{</span>rf_model<span class="sc">.</span>score(X_tr, y_tr)<span class="sc">:.2%}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training accuracy: 100.00%</code></pre>
</div>
</div>
</section>
<section id="feature-importance" class="level3" data-number="14.6.2">
<h3 data-number="14.6.2" class="anchored" data-anchor-id="feature-importance"><span class="header-section-number">14.6.2</span> Feature Importance</h3>
<p>One advantage of Random Forest: we can see which features (words) matter most:</p>
<div id="a36d0650" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature'</span>: available_mw1,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'importance'</span>: rf_model.feature_importances_</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Top 20 most important features:"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance.head(<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 20 most important features:
   feature  importance
59    upon    0.197918
39      on    0.103972
54   there    0.078205
12      by    0.077218
57      to    0.049214
4      and    0.048835
64   which    0.024699
68   would    0.022795
38      of    0.019039
0        a    0.018555
26      in    0.018129
35      no    0.017874
56    this    0.017812
8       at    0.017394
17   every    0.017315
45  should    0.016665
27    into    0.015672
46      so    0.014967
28      is    0.013733
20     had    0.012681</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: Importance measures how much each word reduces classification uncertainty (Gini impurity). Higher values = better at distinguishing Hamilton from Madison. The Random Forest averages importance across all 100 trees.</p>
</section>
<section id="validation" class="level3" data-number="14.6.3">
<h3 data-number="14.6.3" class="anchored" data-anchor-id="validation"><span class="header-section-number">14.6.3</span> Validation</h3>
<p>Let’s test on the held-out validation set:</p>
<div id="e352823e" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>y_pred_val <span class="op">=</span> rf_model.predict(X_val)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Validation accuracy: </span><span class="sc">{</span>accuracy_score(y_val, y_pred_val)<span class="sc">:.2%}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Confusion Matrix:"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_val, y_pred_val))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Classification Report:"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val, y_pred_val))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Validation accuracy: 100.00%

Confusion Matrix:
[[10  0]
 [ 0  3]]

Classification Report:
              precision    recall  f1-score   support

    Hamilton       1.00      1.00      1.00        10
     Madison       1.00      1.00      1.00         3

    accuracy                           1.00        13
   macro avg       1.00      1.00      1.00        13
weighted avg       1.00      1.00      1.00        13
</code></pre>
</div>
</div>
<p><strong>Reading the confusion matrix:</strong></p>
<pre><code>             Predicted
             H    M
Actual  H   [10   0]
        M   [ 0   3]</code></pre>
<p>Perfect classification! All Hamiltons correctly identified as Hamilton, all Madisons as Madison.</p>
<p><strong>Classification report metrics:</strong></p>
<ul>
<li><strong>Precision</strong>: Of papers predicted as author X, what % were actually by X?</li>
<li><strong>Recall</strong>: Of papers truly by author X, what % did we correctly identify?</li>
<li><strong>F1-score</strong>: Harmonic mean balancing precision and recall</li>
<li><strong>Support</strong>: Number of papers by each author in validation set</li>
</ul>
<p>These metrics matter especially with imbalanced classes (51 Hamilton vs 14 Madison papers).</p>
</section>
</section>
<section id="full-model-all-mw-variables" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="full-model-all-mw-variables"><span class="header-section-number">14.7</span> Full Model: All M&amp;W Variables</h2>
<p>Now let’s use all 180 variables:</p>
<div id="112f742c" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all M&amp;W variables</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>available_mw_all <span class="op">=</span> [word <span class="cf">for</span> word <span class="kw">in</span> mw_all <span class="cf">if</span> word <span class="kw">in</span> train_data.columns]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>train_all <span class="op">=</span> train_data.select([<span class="st">'doc_id'</span>, <span class="st">'author_id'</span>] <span class="op">+</span> available_mw_all)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to numpy</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>X_train_all <span class="op">=</span> train_all.select(available_mw_all).to_numpy()</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>y_train_all <span class="op">=</span> train_all.select(<span class="st">'author_id'</span>).to_numpy().flatten()</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Split</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>X_tr2, X_val2, y_tr2, y_val2 <span class="op">=</span> train_test_split(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    X_train_all, y_train_all, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">123</span>, stratify<span class="op">=</span>y_train_all</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Feature matrix: </span><span class="sc">{</span>X_train_all<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Feature matrix: (65, 180)</code></pre>
</div>
</div>
<div id="83a38f12" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>rf_model2 <span class="op">=</span> RandomForestClassifier(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    min_samples_split<span class="op">=</span><span class="dv">5</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>rf_model2.fit(X_tr2, y_tr2)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Training accuracy: </span><span class="sc">{</span>rf_model2<span class="sc">.</span>score(X_tr2, y_tr2)<span class="sc">:.2%}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training accuracy: 100.00%</code></pre>
</div>
</div>
<div id="bcf92074" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>feature_importance2 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature'</span>: available_mw_all,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'importance'</span>: rf_model2.feature_importances_</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Top 20 most important features:"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance2.head(<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 20 most important features:
          feature  importance
112            on    0.123860
155          upon    0.078644
150            to    0.056658
143         there    0.051814
31             by    0.047179
172        whilst    0.032703
162         voice    0.026959
10       although    0.025712
169       whether    0.025421
178         would    0.023410
147         those    0.021650
14            and    0.018237
80             in    0.017668
38   consequently    0.017125
161      violence    0.017055
148        though    0.014737
12          among    0.014324
11         always    0.014092
129          same    0.013577
102     necessary    0.013213</code></pre>
</div>
</div>
<div id="e31783d8" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>y_pred_val2 <span class="op">=</span> rf_model2.predict(X_val2)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Validation accuracy: </span><span class="sc">{</span>accuracy_score(y_val2, y_pred_val2)<span class="sc">:.2%}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Validation accuracy: 100.00%</code></pre>
</div>
</div>
</section>
<section id="predict-disputed-papers" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="predict-disputed-papers"><span class="header-section-number">14.8</span> Predict Disputed Papers</h2>
<p>Now for the main event: Who wrote the 12 disputed papers?</p>
<div id="76df9452" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train final model on ALL Hamilton/Madison papers (no validation split)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>final_model <span class="op">=</span> RandomForestClassifier(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    min_samples_split<span class="op">=</span><span class="dv">5</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>final_model.fit(X_train_all, y_train_all)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Final model training accuracy: </span><span class="sc">{</span>final_model<span class="sc">.</span>score(X_train_all, y_train_all)<span class="sc">:.2%}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Final model training accuracy: 100.00%</code></pre>
</div>
</div>
<div id="c17565b5" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare test data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>test_subset <span class="op">=</span> test_data.select([<span class="st">'doc_id'</span>, <span class="st">'author_id'</span>] <span class="op">+</span> available_mw_all)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> test_subset.select(available_mw_all).to_numpy()</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>test_doc_ids <span class="op">=</span> test_subset.select(<span class="st">'doc_id'</span>).to_numpy().flatten()</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>test_probs <span class="op">=</span> final_model.predict_proba(X_test)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="op">=</span> final_model.predict(X_test)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Paper'</span>: test_doc_ids,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Prob_Hamilton'</span>: test_probs[:, <span class="dv">0</span>],</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Prob_Madison'</span>: test_probs[:, <span class="dv">1</span>],</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Predicted_Author'</span>: test_predictions</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Predictions for Disputed Papers:"</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.to_string(index<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Predictions for Disputed Papers:
============================================================
        Paper  Prob_Hamilton  Prob_Madison Predicted_Author
FEDERALIST_49       0.392952      0.607048          Madison
FEDERALIST_50       0.375254      0.624746          Madison
FEDERALIST_51       0.339167      0.660833          Madison
FEDERALIST_52       0.421310      0.578690          Madison
FEDERALIST_53       0.478548      0.521452          Madison
FEDERALIST_54       0.391643      0.608357          Madison
FEDERALIST_55       0.653333      0.346667         Hamilton
FEDERALIST_56       0.407595      0.592405          Madison
FEDERALIST_57       0.412873      0.587127          Madison
FEDERALIST_58       0.417310      0.582690          Madison
FEDERALIST_62       0.354738      0.645262          Madison
FEDERALIST_63       0.484167      0.515833          Madison</code></pre>
</div>
</div>
<section id="visualization" class="level3" data-number="14.8.1">
<h3 data-number="14.8.1" class="anchored" data-anchor-id="visualization"><span class="header-section-number">14.8.1</span> Visualization</h3>
<div id="cell-fig-federalist-predictions" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>papers <span class="op">=</span> results[<span class="st">'Paper'</span>].values</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>x_pos <span class="op">=</span> np.arange(<span class="bu">len</span>(papers))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked bar chart</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>ax.barh(x_pos, results[<span class="st">'Prob_Hamilton'</span>], label<span class="op">=</span><span class="st">'Hamilton'</span>, color<span class="op">=</span><span class="st">'#d62728'</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>ax.barh(x_pos, results[<span class="st">'Prob_Madison'</span>], left<span class="op">=</span>results[<span class="st">'Prob_Hamilton'</span>], </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Madison'</span>, color<span class="op">=</span><span class="st">'#1f77b4'</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision boundary</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(x_pos)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(papers)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Probability'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Federalist Paper'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Authorship Attribution: Disputed Federalist Papers'</span>, </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-federalist-predictions" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-federalist-predictions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="classification-federalist-papers_files/figure-html/fig-federalist-predictions-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-federalist-predictions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.1: Authorship probabilities for disputed Federalist Papers. Most show strong evidence for Madison, while Paper 55 leans toward Hamilton.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="interpretation" class="level2" data-number="14.9">
<h2 data-number="14.9" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">14.9</span> Interpretation</h2>
<p><strong>Our findings:</strong></p>
<ul>
<li><strong>11 papers</strong> predicted as Madison (varying confidence 52-66%)</li>
<li><strong>Paper 55</strong> predicted as Hamilton (65% confidence)</li>
</ul>
<p><strong>Comparison to Mosteller &amp; Wallace (1963):</strong></p>
<ul>
<li>They concluded Madison wrote all disputed papers <em>except possibly</em> Paper 55</li>
<li>Paper 55 had weak evidence—consistent with our low confidence</li>
<li>Later studies using different methods have also suggested Hamilton for Paper 55</li>
</ul>
<p><strong>Key discriminating features:</strong></p>
<p>The Random Forest identified function words as most important—subtle stylistic markers like “upon” (Hamilton), “whilst” (Madison), “there,” “of.” These are words humans might not consciously notice, but algorithms detect reliably.</p>
</section>
<section id="what-this-demonstrates" class="level2" data-number="14.10">
<h2 data-number="14.10" class="anchored" data-anchor-id="what-this-demonstrates"><span class="header-section-number">14.10</span> What This Demonstrates</h2>
<ol type="1">
<li><strong>Stylometry works</strong>: Function word frequencies distinguish authors</li>
<li><strong>Automation enables scale</strong>: What took M&amp;W months takes us minutes</li>
<li><strong>Uncertainty remains</strong>: Some texts (Paper 55) are genuinely ambiguous</li>
<li><strong>Validation matters</strong>: Testing on known authors first builds confidence</li>
</ol>
</section>
<section id="methodological-considerations" class="level2" data-number="14.11">
<h2 data-number="14.11" class="anchored" data-anchor-id="methodological-considerations"><span class="header-section-number">14.11</span> Methodological Considerations</h2>
<section id="why-function-words" class="level3" data-number="14.11.1">
<h3 data-number="14.11.1" class="anchored" data-anchor-id="why-function-words"><span class="header-section-number">14.11.1</span> Why Function Words?</h3>
<p><strong>Function words</strong> (articles, prepositions, conjunctions) are:</p>
<ul>
<li><strong>Frequent</strong>: Occur in every text</li>
<li><strong>Unconscious</strong>: Writers don’t think about them</li>
<li><strong>Stable</strong>: Don’t vary with topic</li>
<li><strong>Distinctive</strong>: Reflect individual style</li>
</ul>
<p><strong>Content words</strong> (nouns, verbs about topics) are:</p>
<ul>
<li><strong>Topic-dependent</strong>: “government,” “liberty” appear in political writing</li>
<li><strong>Conscious</strong>: Authors choose them deliberately</li>
<li><strong>Shared</strong>: Multiple authors discussing Constitution use similar vocabulary</li>
</ul>
</section>
<section id="model-choice-random-forest-vs.-alternatives" class="level3" data-number="14.11.2">
<h3 data-number="14.11.2" class="anchored" data-anchor-id="model-choice-random-forest-vs.-alternatives"><span class="header-section-number">14.11.2</span> Model Choice: Random Forest vs.&nbsp;Alternatives</h3>
<p><strong>Random Forest advantages:</strong></p>
<ul>
<li>No complex hyperparameter tuning needed</li>
<li>Handles nonlinear relationships</li>
<li>Robust to outliers</li>
<li>Feature importance built-in</li>
</ul>
<p><strong>Alternatives you might try:</strong></p>
<ul>
<li><strong>Logistic Regression</strong>: Simpler, more interpretable coefficients</li>
<li><strong>Support Vector Machines (SVM)</strong>: Effective for high-dimensional data</li>
<li><strong>Naive Bayes</strong>: Fast, probabilistic, works well for text</li>
<li><strong>Neural Networks</strong>: Powerful but requires more data</li>
</ul>
</section>
<section id="sample-size-considerations" class="level3" data-number="14.11.3">
<h3 data-number="14.11.3" class="anchored" data-anchor-id="sample-size-considerations"><span class="header-section-number">14.11.3</span> Sample Size Considerations</h3>
<p>We have:</p>
<ul>
<li><strong>51 Hamilton papers</strong>: Plenty for training</li>
<li><strong>14 Madison papers</strong>: Smaller, but sufficient</li>
<li><strong>12 disputed papers</strong>: Reasonable test set</li>
</ul>
<p><strong>Imbalance problem</strong>: 51 Hamilton vs.&nbsp;14 Madison. Random Forest handles this reasonably well, but you could try:</p>
<ul>
<li>Class weighting</li>
<li>Resampling techniques (SMOTE, undersampling)</li>
<li>Stratified cross-validation (which we used)</li>
</ul>
</section>
</section>
<section id="connections-to-other-methods" class="level2" data-number="14.12">
<h2 data-number="14.12" class="anchored" data-anchor-id="connections-to-other-methods"><span class="header-section-number">14.12</span> Connections to Other Methods</h2>
<section id="multi-dimensional-analysis-mda" class="level3" data-number="14.12.1">
<h3 data-number="14.12.1" class="anchored" data-anchor-id="multi-dimensional-analysis-mda"><span class="header-section-number">14.12.1</span> Multi-Dimensional Analysis (MDA)</h3>
<p><a href="#sec-mda">Mini Lab 10</a> examined stylistic dimensions. Classification is:</p>
<ul>
<li><strong>Supervised</strong>: We know the authors</li>
<li><strong>Binary</strong>: Hamilton or Madison?</li>
<li><strong>Predictive</strong>: Goal is accurate classification</li>
</ul>
<p>MDA is:</p>
<ul>
<li><strong>Unsupervised</strong>: Discovers patterns without labels</li>
<li><strong>Continuous</strong>: Multiple dimensions simultaneously</li>
<li><strong>Exploratory</strong>: Goal is understanding variation</li>
</ul>
</section>
<section id="contextual-embeddings" class="level3" data-number="14.12.2">
<h3 data-number="14.12.2" class="anchored" data-anchor-id="contextual-embeddings"><span class="header-section-number">14.12.2</span> Contextual Embeddings</h3>
<p><a href="#sec-embeddings">Mini Lab 11</a> used semantic similarity. You could combine approaches:</p>
<ol type="1">
<li>Extract contextual embeddings for each paper</li>
<li>Use embeddings as features in Random Forest</li>
<li>Compare performance to function words alone</li>
</ol>
</section>
<section id="keyness-analysis" class="level3" data-number="14.12.3">
<h3 data-number="14.12.3" class="anchored" data-anchor-id="keyness-analysis"><span class="header-section-number">14.12.3</span> Keyness Analysis</h3>
<p><a href="#sec-keyness">Keyness</a> identifies distinctive words. Feature importance from Random Forest serves a similar purpose—which words best distinguish authors?</p>
</section>
</section>
<section id="extensions-applications" class="level2" data-number="14.13">
<h2 data-number="14.13" class="anchored" data-anchor-id="extensions-applications"><span class="header-section-number">14.13</span> Extensions &amp; Applications</h2>
<section id="historical-questions" class="level3" data-number="14.13.1">
<h3 data-number="14.13.1" class="anchored" data-anchor-id="historical-questions"><span class="header-section-number">14.13.1</span> Historical Questions</h3>
<p>Authorship attribution can answer:</p>
<ul>
<li><strong>Anonymous texts</strong>: Who wrote this unsigned medieval chronicle?</li>
<li><strong>Disputed works</strong>: Did Shakespeare write the collaborative plays?</li>
<li><strong>Ghostwriting</strong>: Did this politician write their own speeches?</li>
<li><strong>Forgeries</strong>: Is this “newly discovered” document authentic?</li>
</ul>
</section>
<section id="modern-applications" class="level3" data-number="14.13.2">
<h3 data-number="14.13.2" class="anchored" data-anchor-id="modern-applications"><span class="header-section-number">14.13.2</span> Modern Applications</h3>
<ul>
<li><strong>Social media</strong>: Identifying sock puppet accounts</li>
<li><strong>Forensic linguistics</strong>: Author profiling in legal cases</li>
<li><strong>Plagiarism detection</strong>: Did two students collaborate inappropriately?</li>
<li><strong>Literary studies</strong>: Tracking stylistic evolution across an author’s career</li>
</ul>
</section>
<section id="ethical-considerations" class="level3" data-number="14.13.3">
<h3 data-number="14.13.3" class="anchored" data-anchor-id="ethical-considerations"><span class="header-section-number">14.13.3</span> Ethical Considerations</h3>
<p><strong>Privacy concerns:</strong></p>
<ul>
<li>Stylometric techniques can de-anonymize authors</li>
<li>Even brief texts may reveal identity</li>
<li>“Anonymous” writing may not stay anonymous</li>
</ul>
<p><strong>Potential misuse:</strong></p>
<ul>
<li>Surveillance and profiling</li>
<li>Violating confidentiality</li>
<li>Incorrect attributions with serious consequences</li>
</ul>
<p><strong>Best practices:</strong></p>
<ul>
<li>Obtain consent when possible</li>
<li>Be transparent about methods</li>
<li>Acknowledge uncertainty (like Paper 55)</li>
<li>Consider ethical implications of findings</li>
</ul>
</section>
</section>
<section id="summary" class="level2" data-number="14.14">
<h2 data-number="14.14" class="anchored" data-anchor-id="summary"><span class="header-section-number">14.14</span> Summary</h2>
<p><strong>What we accomplished:</strong></p>
<ul>
<li>Replicated Mosteller &amp; Wallace’s famous 1963 study</li>
<li>Used Random Forest for robust classification</li>
<li>Achieved high accuracy on validation data</li>
<li>Predicted authorship of disputed Federalist Papers</li>
</ul>
<p><strong>Key insights:</strong></p>
<ol type="1">
<li>Function words reveal authorial style</li>
<li>Ensemble methods provide robust predictions</li>
<li>Some texts resist confident classification</li>
<li>Computational methods illuminate historical questions</li>
</ol>
<p><strong>Next steps:</strong></p>
<p>Apply these techniques to your own research questions. The combination of careful feature selection, appropriate modeling, and rigorous validation opens doors to answering questions that seemed unanswerable.</p>
</section>
<section id="further-reading" class="level2" data-number="14.15">
<h2 data-number="14.15" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">14.15</span> Further Reading</h2>
<ul>
<li>Mosteller, F., &amp; Wallace, D. L. (1963). <em>Inference and disputed authorship: The Federalist</em>. Addison-Wesley.</li>
<li>Jockers, M. L., &amp; Witten, D. M. (2010). A comparative study of machine learning methods for authorship attribution. <em>Literary and Linguistic Computing</em>, 25(2), 215-223.</li>
<li>Koppel, M., Schler, J., &amp; Argamon, S. (2009). Computational methods in authorship attribution. <em>Journal of the American Society for Information Science and Technology</em>, 60(1), 9-26.</li>
<li>Juola, P. (2008). Authorship attribution. <em>Foundations and Trends in Information Retrieval</em>, 1(3), 233-334.</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-mosteller1963inference" class="csl-entry" role="listitem">
Mosteller, Frederick, and David L Wallace. 1963. <span>“Inference in an Authorship Problem: A Comparative Study of Discrimination Methods Applied to the Authorship of the Disputed Federalist Papers.”</span> Journal Article. <em>Journal of the American Statistical Association</em> 58 (302): 275–309. <a href="https://doi.org/10.1080/01621459.1963.10500849">https://doi.org/10.1080/01621459.1963.10500849</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../tutorials/contextual-embeddings.html" class="pagination-link" aria-label="Contextual Embeddings and Transformers">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Contextual Embeddings and Transformers</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../reports/cbe_01.html" class="pagination-link" aria-label="Coffee Break Experiment #1: From Curiosity to Visualization">
        <span class="nav-page-text">Coffee Break Experiment #1: From Curiosity to Visualization</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/browndw/humanities_analytics/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.557">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Methods in Humanities Analytics - 1&nbsp; Texts, Algorithms, and Black-Boxes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../tutorials/corpus-basics.html" rel="next">
<link href="../index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/text_analysis.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Methods in Humanities Analytics</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/browndw/humanities_analytics" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/sentiment-and-syuzhet.html">Foundations</a></li><li class="breadcrumb-item"><a href="../tutorials/sentiment-and-syuzhet.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Texts, Algorithms, and Black-Boxes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/sentiment-and-syuzhet.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Texts, Algorithms, and Black-Boxes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/corpus-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Corpus Basics: Tokenization and Processing Pipelines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/spacy-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">NLP Processing with spaCy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/frequency-and-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distributions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Core Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/keyness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Keyness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/collocations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Collocations and N-grams</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Time Series Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/topic-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Topic Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Advanced Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/categorical-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">ANOVA and R²: Comparing Groups and Explaining Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/cluster-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Clustering Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Correlation and Multi-Collinearity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/multi-dimensional-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multi-Dimensional Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/contextual-embeddings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Contextual Embeddings and Transformers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/classification-federalist-papers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Classification &amp; Authorship Attribution</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Reports</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/cbe_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coffee Break Experiment #1: From Curiosity to Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/cbe_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coffee Break Experiment #2: From Results to Research</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/cbe_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coffee Break Experiment #3: Final Project Pilot Study</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/final-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Project: Independent Corpus Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reports/statistical-reporting-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Reporting Guide</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Course Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/using-colab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Using Google Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python Packages for This Course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Data Resources</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-syuzhet-controversy" id="toc-the-syuzhet-controversy" class="nav-link active" data-scroll-target="#the-syuzhet-controversy"><span class="header-section-number">1.1</span> The Syuzhet Controversy</a></li>
  <li><a href="#load-packages-and-data" id="toc-load-packages-and-data" class="nav-link" data-scroll-target="#load-packages-and-data"><span class="header-section-number">1.2</span> Load Packages and Data</a></li>
  <li><a href="#prep-the-data-and-calculate-sentiment" id="toc-prep-the-data-and-calculate-sentiment" class="nav-link" data-scroll-target="#prep-the-data-and-calculate-sentiment"><span class="header-section-number">1.3</span> Prep the Data and Calculate Sentiment</a></li>
  <li><a href="#transforming-the-data-with-dct" id="toc-transforming-the-data-with-dct" class="nav-link" data-scroll-target="#transforming-the-data-with-dct"><span class="header-section-number">1.4</span> Transforming the Data with DCT</a>
  <ul class="collapse">
  <li><a href="#what-does-dct-do" id="toc-what-does-dct-do" class="nav-link" data-scroll-target="#what-does-dct-do"><span class="header-section-number">1.4.1</span> What Does DCT Do?</a></li>
  </ul></li>
  <li><a href="#visualizing-the-emotional-arc" id="toc-visualizing-the-emotional-arc" class="nav-link" data-scroll-target="#visualizing-the-emotional-arc"><span class="header-section-number">1.5</span> Visualizing the Emotional Arc</a></li>
  <li><a href="#transformed-vs.-non-transformed-data" id="toc-transformed-vs.-non-transformed-data" class="nav-link" data-scroll-target="#transformed-vs.-non-transformed-data"><span class="header-section-number">1.6</span> Transformed vs.&nbsp;Non-Transformed Data</a></li>
  <li><a href="#different-lexicons-different-results" id="toc-different-lexicons-different-results" class="nav-link" data-scroll-target="#different-lexicons-different-results"><span class="header-section-number">1.7</span> Different Lexicons, Different Results</a></li>
  <li><a href="#so-whats-the-point" id="toc-so-whats-the-point" class="nav-link" data-scroll-target="#so-whats-the-point"><span class="header-section-number">1.8</span> So What’s the Point?</a>
  <ul class="collapse">
  <li><a href="#should-we-use-sentiment-analysis-at-all" id="toc-should-we-use-sentiment-analysis-at-all" class="nav-link" data-scroll-target="#should-we-use-sentiment-analysis-at-all"><span class="header-section-number">1.8.1</span> Should we use sentiment analysis at all?</a></li>
  <li><a href="#what-can-we-actually-learn" id="toc-what-can-we-actually-learn" class="nav-link" data-scroll-target="#what-can-we-actually-learn"><span class="header-section-number">1.8.2</span> What can we actually learn?</a></li>
  <li><a href="#what-should-we-be-skeptical-of" id="toc-what-should-we-be-skeptical-of" class="nav-link" data-scroll-target="#what-should-we-be-skeptical-of"><span class="header-section-number">1.8.3</span> What should we be skeptical of?</a></li>
  <li><a href="#how-much-do-we-need-to-know-about-the-math" id="toc-how-much-do-we-need-to-know-about-the-math" class="nav-link" data-scroll-target="#how-much-do-we-need-to-know-about-the-math"><span class="header-section-number">1.8.4</span> How much do we need to know about the math?</a></li>
  </ul></li>
  <li><a href="#practical-applications" id="toc-practical-applications" class="nav-link" data-scroll-target="#practical-applications"><span class="header-section-number">1.9</span> Practical Applications</a></li>
  <li><a href="#discussion-questions" id="toc-discussion-questions" class="nav-link" data-scroll-target="#discussion-questions"><span class="header-section-number">1.10</span> Discussion Questions</a></li>
  <li><a href="#common-pitfalls" id="toc-common-pitfalls" class="nav-link" data-scroll-target="#common-pitfalls"><span class="header-section-number">1.11</span> Common Pitfalls</a></li>
  <li><a href="#experimentation-ideas" id="toc-experimentation-ideas" class="nav-link" data-scroll-target="#experimentation-ideas"><span class="header-section-number">1.12</span> Experimentation Ideas</a></li>
  <li><a href="#reflection-exploratory-vs.-confirmatory-research" id="toc-reflection-exploratory-vs.-confirmatory-research" class="nav-link" data-scroll-target="#reflection-exploratory-vs.-confirmatory-research"><span class="header-section-number">1.13</span> Reflection: Exploratory vs.&nbsp;Confirmatory Research</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">1.14</span> Further Reading</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">1.15</span> Key Takeaways</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/browndw/humanities_analytics/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/sentiment-and-syuzhet.html">Foundations</a></li><li class="breadcrumb-item"><a href="../tutorials/sentiment-and-syuzhet.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Texts, Algorithms, and Black-Boxes</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Texts, Algorithms, and Black-Boxes</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a target="_blank" href="https://colab.research.google.com/github/browndw/humanities_analytics/blob/main/mini_labs/Mini_Lab_01_syuzhet.ipynb"> <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"> </a></p>
<p>We’re going to start by unpacking the controversy regarding the <strong>syuzhet</strong> package—originally developed for R by Matthew Jockers, and now available in Python as <strong>moodswing</strong>. This is a useful exercise because it gets to some foundational issues in computational text analysis. These are questions you’re going to encounter in your work, so they’re worth considering from the beginning:</p>
<ul>
<li><strong>How much do we know about what’s happening “under the hood”?</strong></li>
<li><strong>How much <em>should</em> we know?</strong></li>
<li><strong>Is showing that <em>Madame Bovary</em> has a downward emotional arc even interesting</strong> (even though it looks cool)?</li>
<li><strong>Can we take something like narrative arcs and apply them to genuinely interesting research questions?</strong></li>
</ul>
<section id="the-syuzhet-controversy" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-syuzhet-controversy"><span class="header-section-number">1.1</span> The Syuzhet Controversy</h2>
<p>In 2015, Matthew Jockers published work on extracting “plot shapes” from novels using sentiment analysis. The approach went viral, appearing in places like <em>The Atlantic</em> and <em>The New York Times</em>. But it also sparked intense debate about whether the methods were sound.</p>
<p>The controversy centered on whether the Discrete Cosine Transform (DCT)—a mathematical technique Jockers borrowed from signal processing—was appropriate for this task, or whether it was imposing patterns on the data that weren’t really there.</p>
<p><strong>Key readings:</strong></p>
<ul>
<li>Annie Swafford’s critique: <a href="https://perma.cc/TYT3-5DTU">Why Syuzhet Doesn’t Work</a></li>
<li>Jockers’ response and updates: <a href="https://web.archive.org/web/20190708100723/http://www.matthewjockers.net/page/2/">Matthew Jockers’ blog (archived)</a></li>
</ul>
<p>This is a case where <strong>the developer didn’t fully understand the statistics</strong> he was applying when he created the package. That’s not necessarily disqualifying—but it means we need to be critical consumers of computational methods.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why Start Here?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sentiment analysis is intuitive—everyone understands the idea of emotional tone in a text. That makes it a good entry point for thinking critically about how we convert human experiences (reading, interpreting) into computational processes (scoring, transforming, visualizing).</p>
</div>
</div>
</section>
<section id="load-packages-and-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="load-packages-and-data"><span class="header-section-number">1.2</span> Load Packages and Data</h2>
<p>We’ll use <strong>moodswing</strong>, the Python implementation inspired by syuzhet, along with some standard data science libraries.</p>
<div id="53346011" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sentiment analysis and narrative trajectories</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> moodswing <span class="im">import</span> (</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    DictionarySentimentAnalyzer,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    Sentencizer,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    DCTTransform,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    prepare_trajectory,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    plot_trajectory</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> moodswing.data <span class="im">import</span> load_sample_text</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Data manipulation and visualization  </span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The novels that Jockers used as examples are included in the <code>moodswing</code> package. There are 4 novels available as sample data:</p>
<div id="3bfb1963" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Available novels</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>novels <span class="op">=</span> [<span class="st">"madame_bovary"</span>, <span class="st">"portrait_of_a_lady"</span>, <span class="st">"dubliners"</span>, <span class="st">"jude_the_obscure"</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For this demonstration, we'll use Madame Bovary</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>doc_id, text <span class="op">=</span> load_sample_text(<span class="st">"madame_bovary"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded: </span><span class="sc">{</span>doc_id<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Length: </span><span class="sc">{</span><span class="bu">len</span>(text)<span class="sc">:,}</span><span class="ss"> characters"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded: madame_bovary
Length: 648,257 characters</code></pre>
</div>
</div>
</section>
<section id="prep-the-data-and-calculate-sentiment" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="prep-the-data-and-calculate-sentiment"><span class="header-section-number">1.3</span> Prep the Data and Calculate Sentiment</h2>
<p>Next, we’ll split the novel into sentences and calculate a sentiment score for each sentence using the <strong>Syuzhet</strong> lexicon (the same dictionary used in the original R package).</p>
<div id="7028fe48" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split text into sentences</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sentencizer <span class="op">=</span> Sentencizer()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> sentencizer.split(text)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of sentences: </span><span class="sc">{</span><span class="bu">len</span>(sentences)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of sentences: 6943</code></pre>
</div>
</div>
<p>Now we’ll score each sentence using the Syuzhet lexicon:</p>
<div id="88bfb1ef" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sentiment analyzer</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>analyzer <span class="op">=</span> DictionarySentimentAnalyzer()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate sentiment scores for each sentence</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># method="syuzhet" uses the same dictionary as the original R package</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> analyzer.sentence_scores(sentences, method<span class="op">=</span><span class="st">"syuzhet"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"First 10 scores: </span><span class="sc">{</span>scores[:<span class="dv">10</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>First 10 scores: [1.2000000000000002, 0.25, 0.0, 1.5, 1.05, 1.2000000000000002, 1.0, -0.25, 0.0, 0.4]</code></pre>
</div>
</div>
<p>Let’s examine these scores in a DataFrame for easier inspection:</p>
<div id="e6cc48df" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe to view scores</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df_scores <span class="op">=</span> pl.DataFrame({</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sentence_num"</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(scores) <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sentiment"</span>: scores,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sentence"</span>: sentences</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View first 10 rows</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_scores.head(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (10, 3)
┌──────────────┬───────────┬─────────────────────────────────┐
│ sentence_num ┆ sentiment ┆ sentence                        │
│ ---          ┆ ---       ┆ ---                             │
│ i64          ┆ f64       ┆ str                             │
╞══════════════╪═══════════╪═════════════════════════════════╡
│ 1            ┆ 1.2       ┆ Part I Chapter One We were in … │
│ 2            ┆ 0.25      ┆ Those who had been asleep woke… │
│ 3            ┆ 0.0       ┆ The head-master made a sign to… │
│ 4            ┆ 1.5       ┆ Then, turning to the class-mas… │
│ 5            ┆ 1.05      ┆ If his work and conduct are sa… │
│ 6            ┆ 1.2       ┆ The "new fellow," standing in … │
│ 7            ┆ 1.0       ┆ His hair was cut square on his… │
│ 8            ┆ -0.25     ┆ Although he was not broad-shou… │
│ 9            ┆ 0.0       ┆ His legs, in blue stockings, l… │
│ 10           ┆ 0.4       ┆ We began repeating the lesson.  │
└──────────────┴───────────┴─────────────────────────────────┘</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Sentiment Scores
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Positive scores</strong> indicate positive emotional valence (happy, good, beautiful)</li>
<li><strong>Negative scores</strong> indicate negative emotional valence (sad, bad, ugly)</li>
<li><strong>Zero scores</strong> mean either neutral or no sentiment words detected</li>
<li>Scores are based on a dictionary lookup—each word has a pre-assigned value</li>
</ul>
</div>
</div>
</section>
<section id="transforming-the-data-with-dct" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="transforming-the-data-with-dct"><span class="header-section-number">1.4</span> Transforming the Data with DCT</h2>
<p>The next step is to transform the data using the <strong>Discrete Cosine Transform (DCT)</strong>. Originally, Jockers used a Fourier transformation, which he described as follows:</p>
<blockquote class="blockquote">
<p>Aaron introduced me to a mathematical formula from signal processing called the Fourier transformation. The Fourier transformation provides a way of decomposing a time based signal and reconstituting it in the frequency domain. A complex signal (such as the one seen above in the first figure in this post) can be decomposed into series of symmetrical waves of varying frequencies. And one of the magical things about the Fourier equation is that these decomposed component sine waves can be added back together (summed) in order to reproduce the original wave form–this is called a backward or reverse transformation. Fourier provides a way of transforming the sentiment-based plot trajectories into an equivalent data form that is independent of the length of the trajectory from beginning to end. The frequency domain begins to solve the book length problem.</p>
</blockquote>
<p>This introduced some unwanted outcomes, namely that the resulting wave-forms must begin and end at the same point. The updated approach uses a <strong>Discrete Cosine Transform (DCT)</strong>, which is commonly used in data compression (like JPEG images and MP3 audio).</p>
<section id="what-does-dct-do" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="what-does-dct-do"><span class="header-section-number">1.4.1</span> What Does DCT Do?</h3>
<p>Think of DCT as a <strong>smoothing filter</strong> that:</p>
<ol type="1">
<li>Removes high-frequency “noise” (sentence-to-sentence variation)</li>
<li>Preserves low-frequency patterns (overall narrative trends)</li>
<li>Can normalize texts of different lengths to the same scale</li>
</ol>
<p><strong>But here’s the critical question:</strong> Is this smoothing <em>revealing</em> patterns that were already there, or <em>creating</em> patterns that weren’t?</p>
<div id="1d72c8c7" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply DCT transformation</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># low_pass_size: how much smoothing (lower = more smoothing)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># output_length: standardize to this many points</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_range: normalize to [-1, 1]</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>trajectory <span class="op">=</span> prepare_trajectory(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    scores,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    rolling_window<span class="op">=</span><span class="va">None</span>,  <span class="co"># Optional: can add moving average first</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    dct_transform<span class="op">=</span>DCTTransform(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        low_pass_size<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        output_length<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        scale_range<span class="op">=</span><span class="va">True</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Original scores: </span><span class="sc">{</span><span class="bu">len</span>(scores)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Transformed trajectory: </span><span class="sc">{</span><span class="bu">len</span>(trajectory.dct)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"First 10 transformed values: </span><span class="sc">{</span>trajectory<span class="sc">.</span>dct[:<span class="dv">10</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original scores: 6943
Transformed trajectory: 100
First 10 transformed values: [1.         0.99718023 0.99156374 0.9831964  0.9721465  0.95850405
 0.94237997 0.92390505 0.90322867 0.88051744]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2581/1286228209.py:6: UserWarning: DCT transform already has scaling enabled (scale_range=True, scale_values=False). Skipping additional normalization of DCT output to prevent double-scaling. Raw and rolling components are still normalized.
  trajectory = prepare_trajectory(</code></pre>
</div>
</div>
<p>Notice how we went from thousands of individual sentence scores to 100 smoothed trajectory points.</p>
</section>
</section>
<section id="visualizing-the-emotional-arc" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="visualizing-the-emotional-arc"><span class="header-section-number">1.5</span> Visualizing the Emotional Arc</h2>
<p>Now we can plot the transformed sentiment trajectory:</p>
<div id="c4e9f42b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot_trajectory(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    trajectory,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Madame Bovary: Emotional Arc"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    components<span class="op">=</span>[<span class="st">"dct"</span>],  <span class="co"># Only show DCT-transformed trajectory</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    colors<span class="op">=</span>{<span class="st">"dct"</span>: <span class="st">"tomato"</span>}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Normalized Narrative Time"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Emotional Valence"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="sentiment-and-syuzhet_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Sentiment trajectory in <em>Madame Bovary</em> using DCT transformation.</figcaption>
</figure>
</div>
</div>
</div>
<p>This produces the characteristic “plot shape” that Jockers popularized—a smooth curve showing the emotional journey of the narrative.</p>
<p><strong>Question to ponder:</strong> Does this curve tell us something <em>meaningful</em> about <em>Madame Bovary</em>? Or is it just a pretty picture?</p>
</section>
<section id="transformed-vs.-non-transformed-data" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="transformed-vs.-non-transformed-data"><span class="header-section-number">1.6</span> Transformed vs.&nbsp;Non-Transformed Data</h2>
<p>To better understand what the DCT is doing, let’s compare the raw sentence-level scores with the smoothed trajectory.</p>
<p>First, we’ll create a normalized version of the raw scores:</p>
<div id="96573b56" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize raw scores to same scale as DCT output</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>raw_sentiment <span class="op">=</span> np.array(scores)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>raw_normalized <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (raw_sentiment <span class="op">-</span> raw_sentiment.<span class="bu">min</span>()) <span class="op">/</span> (raw_sentiment.<span class="bu">max</span>() <span class="op">-</span> raw_sentiment.<span class="bu">min</span>()) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create normalized time values</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>raw_time <span class="op">=</span> np.arange(<span class="bu">len</span>(raw_sentiment)) <span class="op">/</span> <span class="bu">len</span>(raw_sentiment) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># DCT time values</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>dct_time <span class="op">=</span> np.arange(<span class="bu">len</span>(trajectory.dct)) <span class="op">/</span> <span class="bu">len</span>(trajectory.dct) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now plot both together:</p>
<div id="0d03a0a2" class="cell" data-fig-height="5" data-fig-width="9" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot raw scores as scatter</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(raw_time, raw_normalized, alpha<span class="op">=</span><span class="fl">0.2</span>, s<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'gray'</span>, label<span class="op">=</span><span class="st">'Raw scores'</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot DCT trajectory as line</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.plot(dct_time, trajectory.dct, color<span class="op">=</span><span class="st">'tomato'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'DCT smoothed'</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Normalized Narrative Time'</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled Sentiment'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Madame Bovary: Raw vs. Transformed Sentiment'</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="sentiment-and-syuzhet_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
<figcaption>Raw sentiment scores (gray points) vs.&nbsp;DCT-smoothed trajectory (red line) in <em>Madame Bovary</em>.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Critical Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>Look at that plot carefully. The gray points are the <em>actual</em> sentiment scores from the text. The red line is what DCT produces.</p>
<p><strong>Is the red line:</strong></p>
<p>A. <strong>Revealing</strong> an underlying pattern that was hidden in the noisy data?</p>
<p>B. <strong>Imposing</strong> a smooth curve that makes the data look more structured than it really is?</p>
<p>This is not just a theoretical question—it’s about whether we can trust what the algorithm is telling us.</p>
</div>
</div>
</section>
<section id="different-lexicons-different-results" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="different-lexicons-different-results"><span class="header-section-number">1.7</span> Different Lexicons, Different Results</h2>
<p>One reason to be skeptical: <strong>different sentiment lexicons produce different results</strong>. The <code>moodswing</code> package includes four lexicons:</p>
<div id="184ed767" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare different sentiment lexicons</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>lexicons <span class="op">=</span> [<span class="st">"syuzhet"</span>, <span class="st">"afinn"</span>, <span class="st">"bing"</span>, <span class="st">"nrc"</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Madame Bovary: Different Sentiment Lexicons'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, lexicon <span class="kw">in</span> <span class="bu">enumerate</span>(lexicons):</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate scores with this lexicon</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    scores_lex <span class="op">=</span> analyzer.sentence_scores(sentences, method<span class="op">=</span>lexicon)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transform</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    traj_lex <span class="op">=</span> prepare_trajectory(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        scores_lex,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        dct_transform<span class="op">=</span>DCTTransform(low_pass_size<span class="op">=</span><span class="dv">5</span>, output_length<span class="op">=</span><span class="dv">100</span>, scale_range<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[idx <span class="op">//</span> <span class="dv">2</span>, idx <span class="op">%</span> <span class="dv">2</span>]</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    ax.plot(traj_lex.dct, color<span class="op">=</span><span class="st">'tomato'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'</span><span class="sc">{</span>lexicon<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss"> Lexicon'</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Narrative Time'</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Sentiment'</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sentiment-and-syuzhet_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If the method were revealing something <em>real</em> about the novel’s emotional structure, wouldn’t all lexicons show roughly the same pattern?</p>
</section>
<section id="so-whats-the-point" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="so-whats-the-point"><span class="header-section-number">1.8</span> So What’s the Point?</h2>
<p>This brings us back to our opening questions:</p>
<section id="should-we-use-sentiment-analysis-at-all" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="should-we-use-sentiment-analysis-at-all"><span class="header-section-number">1.8.1</span> Should we use sentiment analysis at all?</h3>
<p><strong>Yes</strong>, but critically. It’s a tool, not a magic answer machine.</p>
</section>
<section id="what-can-we-actually-learn" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="what-can-we-actually-learn"><span class="header-section-number">1.8.2</span> What can we actually learn?</h3>
<ul>
<li><strong>Comparative patterns</strong> across many texts might be meaningful</li>
<li><strong>Relative differences</strong> between authors, genres, or time periods</li>
<li><strong>Exploratory insights</strong> that lead to closer reading</li>
</ul>
</section>
<section id="what-should-we-be-skeptical-of" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3" class="anchored" data-anchor-id="what-should-we-be-skeptical-of"><span class="header-section-number">1.8.3</span> What should we be skeptical of?</h3>
<ul>
<li><strong>Single-text “findings”</strong> (one curve doesn’t tell us much)</li>
<li><strong>Over-interpretation</strong> of smooth patterns</li>
<li><strong>Treating scores as truth</strong> rather than rough approximations</li>
<li><strong>Ignoring what the method assumes</strong> about language and emotion</li>
</ul>
</section>
<section id="how-much-do-we-need-to-know-about-the-math" class="level3" data-number="1.8.4">
<h3 data-number="1.8.4" class="anchored" data-anchor-id="how-much-do-we-need-to-know-about-the-math"><span class="header-section-number">1.8.4</span> How much do we need to know about the math?</h3>
<p>You don’t need to derive the DCT formula. But you <strong>should</strong> understand:</p>
<ul>
<li>What the method is trying to do (smooth noisy data)</li>
<li>What assumptions it makes (emotions are continuous, texts have structure)</li>
<li>What could go wrong (imposing patterns, missing context)</li>
<li>How to interpret results critically</li>
</ul>
</section>
</section>
<section id="practical-applications" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="practical-applications"><span class="header-section-number">1.9</span> Practical Applications</h2>
<p>Despite the controversy, sentiment trajectory analysis can be genuinely useful when applied to interesting questions:</p>
<p><strong>Good uses:</strong></p>
<ul>
<li>Comparing narrative structures across genres (do mysteries have different arcs than romances?)</li>
<li>Tracking emotional tone in historical documents over time</li>
<li>Analyzing sentiment patterns in social media during events</li>
<li>Exploring how different authors structure emotional progression</li>
</ul>
<p><strong>Less useful:</strong></p>
<ul>
<li>Claiming to have discovered “the seven basic plots” from curves</li>
<li>Using a single novel’s trajectory as evidence for anything</li>
<li>Ignoring literary context and close reading</li>
<li>Treating sentiment scores as psychological reality</li>
</ul>
</section>
<section id="discussion-questions" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="discussion-questions"><span class="header-section-number">1.10</span> Discussion Questions</h2>
<ol type="1">
<li><p><strong>Methodological skepticism</strong>: If four different sentiment lexicons produce four different trajectory shapes for the same novel, what does that tell us about the validity of plot shape analysis? Can any of them be “right”?</p></li>
<li><p><strong>Signal vs.&nbsp;noise</strong>: Looking at the raw vs.&nbsp;transformed plot, how do you decide whether DCT is revealing a meaningful pattern or creating an artificial one? What evidence would convince you either way?</p></li>
<li><p><strong>Research design</strong>: Imagine you want to compare emotional arcs across 1,000 Victorian novels. What would make this a compelling research question? What would you need to do beyond generating trajectory plots?</p></li>
<li><p><strong>Interpretive authority</strong>: Traditional literary criticism involves close reading and interpretation. When we let an algorithm smooth sentiment scores into a plot shape, who or what is doing the interpreting? How does this change the nature of literary analysis?</p></li>
<li><p><strong>The “cool visualization” problem</strong>: The trajectory plots <em>look</em> impressive and scientific. How do you guard against being seduced by the aesthetic appeal of computational output? When does a pretty graph become misleading?</p></li>
<li><p><strong>Vocabulary and culture</strong>: Sentiment lexicons assign fixed emotional values to words. But word meanings change across time, cultures, and contexts. How might this affect analysis of historical texts? What about texts from different English-speaking countries?</p></li>
</ol>
</section>
<section id="common-pitfalls" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="common-pitfalls"><span class="header-section-number">1.11</span> Common Pitfalls</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What Can Go Wrong
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Over-smoothing</strong>: Too much smoothing (low <code>low_pass_size</code>) can make everything look like a simple downward or upward arc, erasing meaningful variation.</p>
<p><strong>Single-text findings</strong>: One novel’s trajectory tells you very little. You need comparative analysis across multiple texts to make claims.</p>
<p><strong>Ignoring genre conventions</strong>: Romance novels might systematically differ from tragedies not because of authorial choice but because of genre requirements.</p>
<p><strong>Decontextualization</strong>: A word like “awful” meant “awe-inspiring” in older texts, not “terrible.” Sentiment dictionaries don’t account for historical semantic change.</p>
<p><strong>The replication trap</strong>: Just because you can reproduce Jockers’ results doesn’t mean the method is sound—it might just mean you’re making the same assumptions.</p>
</div>
</div>
</section>
<section id="experimentation-ideas" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="experimentation-ideas"><span class="header-section-number">1.12</span> Experimentation Ideas</h2>
<p>For hands-on practice, try:</p>
<ol type="1">
<li><p><strong>Compare novels</strong>: Load different novels from the sample data and compare their trajectories. Do different authors show different patterns?</p></li>
<li><p><strong>Adjust smoothing</strong>: Experiment with <code>low_pass_size</code> values from 2 to 20. How does this change the shape? At what point does it become meaningless?</p></li>
<li><p><strong>Genre analysis</strong>: If you had access to 100 mystery novels and 100 romances, how would you test whether they have systematically different emotional arcs?</p></li>
<li><p><strong>Critical replication</strong>: Try to reproduce one of Jockers’ original plots. Does your version match his? What might account for differences?</p></li>
<li><p><strong>Lexicon archaeology</strong>: Look up the actual Syuzhet dictionary. What words are included? What values do they have? Do you agree with the assignments?</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
For the Mini Lab
</div>
</div>
<div class="callout-body-container callout-body">
<p>The corresponding <a href="../mini_labs/Mini_Lab_01_syuzhet.ipynb">Mini Lab 01</a> provides a Colab environment where you can experiment with this code hands-on, trying different texts and parameters without installing anything locally.</p>
</div>
</div>
</section>
<section id="reflection-exploratory-vs.-confirmatory-research" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="reflection-exploratory-vs.-confirmatory-research"><span class="header-section-number">1.13</span> Reflection: Exploratory vs.&nbsp;Confirmatory Research</h2>
<p>This tutorial has focused on critical evaluation of a specific method, but the broader lesson is about <strong>how we use computational tools in humanities research</strong>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Two Modes of Research
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Exploratory analysis</strong>: Using computational methods to discover patterns, generate hypotheses, identify texts for closer reading. This is valuable! But findings are tentative and need validation.</p>
<p><strong>Confirmatory research</strong>: Testing specific hypotheses with appropriate methods and transparent assumptions. This is where computational analysis can make strong claims—but only with careful design.</p>
<p>The syuzhet controversy arose partly because exploratory findings (“look at these interesting plot shapes!”) were presented as if they were confirmatory results (“novels have six basic emotional arcs”).</p>
</div>
</div>
<p><strong>The takeaway</strong>: Use sentiment trajectory analysis as an exploratory tool to identify interesting patterns or texts. Then do the interpretive work—close reading, historical contextualization, comparative analysis—to understand what those patterns mean.</p>
<p>Computational methods don’t replace humanistic interpretation; they give us new ways to <strong>formulate questions</strong> and <strong>identify what’s worth interpreting</strong>.</p>
</section>
<section id="further-reading" class="level2" data-number="1.14">
<h2 data-number="1.14" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">1.14</span> Further Reading</h2>
<ul>
<li>Swafford, A. (2015). <a href="https://perma.cc/TYT3-5DTU">Problems with the Syuzhet Package</a></li>
<li>Jockers, M. (2015). <a href="https://web.archive.org/web/20190708100723/http://www.matthewjockers.net/page/2/">Revealing Sentiment and Plot Arcs with the Syuzhet Package</a></li>
<li>Piper, A. (2018). <em>Enumerations: Data and Literary Study</em>. University of Chicago Press. (Chapter on sentiment)</li>
<li>Reagan, A.J., et al.&nbsp;(2016). “The emotional arcs of stories are dominated by six basic shapes.” <em>EPJ Data Science</em>, 5(1), 31.</li>
<li>Underwood, T. (2019). <em>Distant Horizons: Digital Evidence and Literary Change</em>. University of Chicago Press. (On appropriate use of computational methods)</li>
</ul>
</section>
<section id="key-takeaways" class="level2" data-number="1.15">
<h2 data-number="1.15" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">1.15</span> Key Takeaways</h2>
<ol type="1">
<li><strong>Computational methods are not neutral</strong> - They make assumptions and can impose structure</li>
<li><strong>Understanding matters</strong> - You need to know what methods do, even if not the full math</li>
<li><strong>Be critical</strong> - Cool visualizations aren’t the same as meaningful findings</li>
<li><strong>Context is essential</strong> - Numbers need interpretation informed by domain knowledge</li>
<li><strong>Tools enable questions</strong> - Use methods to explore interesting problems, not just to make pretty graphs</li>
</ol>
<p>This controversy from 2015 is still relevant because these issues apply to <em>all</em> computational humanities work: text classification, topic modeling, word embeddings, and more. The questions don’t go away—how much do we know, how much should we know, and what counts as a meaningful finding?</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link" aria-label="Welcome">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Welcome</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../tutorials/corpus-basics.html" class="pagination-link" aria-label="Corpus Basics: Tokenization and Processing Pipelines">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Corpus Basics: Tokenization and Processing Pipelines</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/browndw/humanities_analytics/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>